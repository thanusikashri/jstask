<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple To-Do List</title>
</head>
<style>
    body {
        background-image: url("bg.jpg");
        background-size: cover;
        background-repeat: no-repeat;
    }

    h1 {
        margin-top: 50px;
        font-size: 40px;
    }

    li {
        text-align: center;
        font-size: 22px;
        margin-bottom: 15px;
        list-style-type: none;
        background-color: rgba(0, 0, 0, 0.2);
        padding: 5px;
        border-radius: 8px;
        width: 30%;
        margin-left: 33%;
    }

    input, button, select {
        padding: 8px;
        margin: 8px;
    }

    button {
        cursor: pointer;
    }

    .completed {
        text-decoration: line-through;
        color: rgb(41, 37, 37); 
    }

    .inp {
        background-color: rgba(0, 0, 0, 0.4);
        padding: 10px;
        border-radius: 8px;
        width: 30%;
    }

</style>
<body>
    <center><h1>üßæ Simple To-Do List</h1></center>
    <br>
    <br>
    <center><div class="inp">
        <input list="taskSuggestions" id="taskInput" placeholder="Enter a new event...">

        <datalist id="taskSuggestions">
        <option value="PS Assessment"></option>
        <option value="Study Session"></option>
        <option value="Workout"></option>
        <option value="Doctor Appointment"></option>
        <option value="Project Work"></option>
        <option value="Shopping"></option>
        </datalist>
        
        <input type="datetime-local" id="taskDate">

        <h3 style="font-size: 23px; margin-bottom: 5px;">Priority:</h3>

        <select id="priority">
            <option value="Low">Low</option>
            <option value="Medium" selected>Medium</option>
            <option value="High">High</option>
        </select><br><br>
        
        <button onclick="addTask()" style="background-color: rgb(73, 192, 192);">Add Event</button>
    </div></center>

    <ul id="taskList"></ul>

    <script>
        let tasks = [];

        function addTask() {
            let input = document.getElementById("taskInput");
            let taskName = input.value.trim();
            let dateInput = document.getElementById("taskDate");
            let eventDate = dateInput.value;
            let priority = document.getElementById("priority").value;
            
            let promise = new Promise((resolve, reject) => {
                if (taskName === "") {
                    reject("Task name cannot be empty!");
                    return;
                }

                if (eventDate === "") {
                    reject("Please select a Date and Time!");
                    return;
                }
                const task = {
                        id: Math.floor(Math.random() * 1000),
                        name: taskName,
                        eventDate: new Date(eventDate).toLocaleString(),
                        completed: false,
                        createdAt: new Date().toLocaleString(),
                        priority: priority
                    };

                    tasks.push(task);
                    resolve("Task added successfully!");
            });

            promise.then((message) => {
                alert(message);
                input.value = "";
                dateInput.value = "";

                viewTask();
            })
            .catch((error) => {
                alert(error);
            });
        }

        function viewTask() {
            const list = document.getElementById("taskList");
            list.innerHTML = "";

            if (tasks.length === 0) {
                list.innerHTML = "<li>No tasks found!</li>";
                return;
            }

            let html = "";

            for (let task of tasks) {
                html += `
                <li>
                    <div class="task-info">
                        <strong class="${task.completed ? 'completed' : ''}" style="font-size: 32px">${task.name}<br><br></strong>
                        <small>Created at: ${task.createdAt}</small><br>
                        <small>Event Date: ${task.eventDate}</small><br>
                        <small style="color:${task.priority==='High'?'darkred':task.priority==='Low'?'darkgreen':'yellow'}">Priority: ${task.priority}</small><br><br>
                    </div>
                    <div class="btn-group">
                        <button onclick="markCompleted(${task.id})">‚úîÔ∏è Done</button>
                        <button onclick="deleteTask(${task.id})">üóëÔ∏è Delete</button><br>
                    </div>
                </li>
            `;
            }

            list.innerHTML = html;
        }

        function deleteTask(id) {
            try {
                const index = tasks.findIndex(task => task.id === id);
                if (index === -1) {
                    throw new Error("Task not found!");
                }
                tasks.splice(index, 1);
                viewTask();
            } catch (err) {
                alert(err.message);
            }
        }

        function markCompleted(id) {
            const task = tasks.find(task => task.id === id);
            if (task) {
                task.completed = true;
                viewTask();
            } else {
                alert("Task not found!");
            }
        }
    </script>
</body>
</html>